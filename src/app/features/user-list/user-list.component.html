<button
  (click)="triggerPopup()"
  class="rounded bg-blue-600 px-4 py-2 text-white hover:bg-blue-700"
>
  Add new user
</button>
<!-- Actions & Search -->
<div class="mb-4 flex flex-wrap items-center gap-2">
  <button
    (click)="selectAllUsers()"
    class="rounded border bg-gray-200 px-3 py-1"
  >
    Select All
  </button>
  <button
    class="rounded bg-red-600 px-4 py-2 text-white"
    (click)="openBulkDeletionPopup()"
    [disabled]="selectedUsers.size === 0"
  >
    Delete Selected
  </button>
  <button
    class="rounded bg-yellow-500 px-4 py-2 text-white"
    (click)="blockInBulk(true)"
    [disabled]="selectedUsers.size === 0"
  >
    Block Selected
  </button>
  <button
    class="rounded bg-green-600 px-4 py-2 text-white"
    (click)="blockInBulk(false)"
    [disabled]="selectedUsers.size === 0"
  >
    Unblock Selected
  </button>
  <button
    (click)="addRandomUsers()"
    class="rounded bg-blue-600 px-4 py-2 text-white"
  >
    Add 1 Random User
  </button>
  <input
    type="text"
    placeholder="Search by name or email"
    class="min-w-[200px] flex-1 rounded border px-3 py-2"
    [value]="searchText()"
    (input)="searchText.set($any($event.target).value)"
  />
</div>
<!-- Filters + Sorting (Above User Cards) -->
<div class="mb-4 flex flex-wrap items-center justify-between gap-2">
  <!-- Filters -->
  <div class="flex flex-wrap gap-2">
    <button
      (click)="statusFilter.set('all')"
      [class.bg-blue-500]="statusFilter() === 'all'"
      [class.text-white]="statusFilter() === 'all'"
      class="btn rounded border px-3 py-1"
    >
      All
    </button>
    <button
      (click)="statusFilter.set('vip')"
      [class.bg-blue-500]="statusFilter() === 'vip'"
      [class.text-white]="statusFilter() === 'vip'"
      class="btn rounded border px-3 py-1"
    >
      VIP
    </button>
    <button
      (click)="statusFilter.set('active')"
      [class.bg-blue-500]="statusFilter() === 'active'"
      [class.text-white]="statusFilter() === 'active'"
      class="btn rounded border px-3 py-1"
    >
      Active
    </button>
    <button
      (click)="statusFilter.set('blocked')"
      [class.bg-blue-500]="statusFilter() === 'blocked'"
      [class.text-white]="statusFilter() === 'blocked'"
      class="btn rounded border px-3 py-1"
    >
      Blocked
    </button>
    <button
      (click)="statusFilter.set('inactive')"
      [class.bg-blue-500]="statusFilter() === 'inactive'"
      [class.text-white]="statusFilter() === 'inactive'"
      class="btn rounded border px-3 py-1"
    >
      Inactive
    </button>
  </div>

  <!-- Sorting Button -->
  <button
    (click)="toggleSortDirection()"
    class="flex items-center gap-2 rounded border border-gray-400 bg-purple-600 px-4 py-2 font-semibold text-white shadow transition hover:bg-purple-700"
  >
    Sorting:
    <span class="flex items-center gap-1">
      @if (sortAscending()) {
        Ascending
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="inline-block h-4 w-4"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
          stroke-width="2"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M5 15l7-7 7 7"
          />
        </svg>
      } @else {
        Descending
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="inline-block h-4 w-4"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
          stroke-width="2"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M19 9l-7 7-7-7"
          />
        </svg>
      }
    </span>
  </button>
</div>
<!-- User Cards -->
<div class="flex flex-col gap-4">
  @for (user of paginatedUsers(); track trackByUserId($index, user)) {
    <div
      class="flex flex-wrap items-center justify-between gap-4 rounded-lg border bg-white p-4 shadow-sm"
    >
      <!-- Checkbox -->
      <input
        type="checkbox"
        [checked]="isUserSelected(user)"
        (change)="toggleUserSelection(user)"
        class="h-5 w-5"
      />

      <!-- ID -->
      <div class="w-10 text-center font-mono">{{ user.userId }}</div>

      <!-- Avatar -->
      <div class="flex items-center justify-center">
        <div
          class="h-12 w-12 overflow-hidden rounded-full border-4"
          [ngClass]="{
            'border-green-500': user.active,
            'border-red-500': !user.active,
          }"
        >
          <img
            src="{{ user.picture }}"
            alt="avatar"
            class="h-full w-full object-cover"
          />
        </div>
      </div>

      <!-- Username + Blocked Icon -->
      <div class="flex flex-1 items-center gap-2">
        {{ user.username }}
        @if (user.blocked) {
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="currentColor"
            viewBox="0 0 24 24"
            class="h-6 w-6 text-red-500"
          >
            <path
              d="M12 2C9.8 2 8 3.8 8 6v4H7c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2v-8c0-1.1-.9-2-2-2h-1V6c0-2.2-1.8-4-4-4zm-2 4c0-1.1.9-2 2-2s2 .9 2 2v4h-4V6zm2 10c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1-.4 1-1 1z"
            />
          </svg>
        }
      </div>

      <!-- Active / VIP / Email -->
      <div class="w-20 text-center">
        {{ user.active ? 'Active' : 'Inactive' }}
      </div>
      <div class="w-20 text-center">{{ user.vip ? 'Vip' : 'Non Vip' }}</div>
      <div class="flex-1 break-words">
        <span class="font-bold">Email address:</span> {{ user.email }}
      </div>

      <!-- Actions -->
      <div class="flex gap-2">
        <button
          class="rounded border bg-gray-200 px-2 py-1"
          (click)="toggleBlocked(user)"
        >
          {{ user.blocked ? 'Unblock' : 'Block' }}
        </button>
        <button
          class="rounded border bg-red-600 px-2 py-1 text-white"
          (click)="deleteUserPopUp(user)"
        >
          Delete
        </button>
      </div>
    </div>
  }
</div>
